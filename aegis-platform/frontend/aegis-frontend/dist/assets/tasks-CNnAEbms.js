import{r as i,j as e,E as D,L as U,a7 as h,H as L,J as B,a0 as $}from"./react-vendor-B391mDFM.js";import{D as G,l as J,m as Q,n as K,o as W,p as u,I as T,T as X,S as O,q as V,s as E,t as q,u as I,v as Y,w as Z,B as x,h as ee,x as se,y as ae,z as te,A,L as le,C as g,a as j,b as v,c as N,d as re,e as M}from"./assessments-CKARqxWC.js";import{f as z}from"./vendor-BAj2-sgi.js";const ie=[{value:"Low",label:"Low Priority"},{value:"Medium",label:"Medium Priority"},{value:"High",label:"High Priority"},{value:"Critical",label:"Critical Priority"}],ne=["Security Review","Compliance Task","Risk Assessment","Vulnerability Remediation","Policy Update","Training Task","Audit Task","Incident Response","General Task"];function ce({open:m,onOpenChange:w,onTaskCreated:c}){const[p,k]=i.useState(!1),[f,o]=i.useState(null),[n,C]=i.useState(),[l,r]=i.useState({title:"",description:"",priority:"",type:"",assigned_to:"",category:""}),b=()=>{r({title:"",description:"",priority:"",type:"",assigned_to:"",category:""}),C(void 0),o(null),w(!1)},S=async a=>{var t,y;if(a.preventDefault(),!l.title.trim()){o("Task title is required");return}if(!l.priority){o("Priority selection is required");return}k(!0),o(null);try{const d={...l,due_date:n?z(n,"yyyy-MM-dd"):null,status:"Open",progress:0,created_date:new Date().toISOString()};console.log("Creating task with data:",d),await A.create(d),console.log("✅ Task created successfully"),c&&c(),b()}catch(d){console.error("❌ Failed to create task:",d),o(((y=(t=d.response)==null?void 0:t.data)==null?void 0:y.message)||d.message||"Failed to create task")}finally{k(!1)}};return e.jsx(G,{open:m,onOpenChange:w,children:e.jsxs(J,{className:"sm:max-w-[600px] max-h-[90vh] overflow-y-auto",children:[e.jsxs(Q,{children:[e.jsx(K,{children:"Create New Task"}),e.jsx(W,{children:"Create a new security or compliance task. Fill in the details below to get started."})]}),e.jsxs("form",{onSubmit:S,className:"space-y-6",children:[f&&e.jsx("div",{className:"bg-destructive/15 text-destructive text-sm p-3 rounded-md",children:f}),e.jsxs("div",{className:"grid gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{htmlFor:"title",children:"Task Title *"}),e.jsx(T,{id:"title",placeholder:"e.g., Review firewall configuration for Q4",value:l.title,onChange:a=>r(t=>({...t,title:a.target.value})),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{htmlFor:"description",children:"Description"}),e.jsx(X,{id:"description",placeholder:"Describe the task objectives and requirements...",value:l.description,onChange:a=>r(t=>({...t,description:a.target.value})),rows:3})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{htmlFor:"priority",children:"Priority *"}),e.jsxs(O,{value:l.priority,onValueChange:a=>r(t=>({...t,priority:a})),required:!0,children:[e.jsx(V,{children:e.jsx(E,{placeholder:"Select priority"})}),e.jsx(q,{children:ie.map(a=>e.jsx(I,{value:a.value,children:a.label},a.value))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{htmlFor:"type",children:"Task Type"}),e.jsxs(O,{value:l.type,onValueChange:a=>r(t=>({...t,type:a})),children:[e.jsx(V,{children:e.jsx(E,{placeholder:"Select type"})}),e.jsx(q,{children:ne.map(a=>e.jsx(I,{value:a,children:a},a))})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{htmlFor:"assigned_to",children:"Assigned To"}),e.jsx(T,{id:"assigned_to",placeholder:"Enter assignee name",value:l.assigned_to,onChange:a=>r(t=>({...t,assigned_to:a.target.value}))})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{children:"Due Date"}),e.jsxs(Y,{children:[e.jsx(Z,{asChild:!0,children:e.jsxs(x,{variant:"outline",className:ee("w-full justify-start text-left font-normal",!n&&"text-muted-foreground"),children:[e.jsx(D,{className:"mr-2 h-4 w-4"}),n?z(n,"PPP"):"Select due date"]})}),e.jsx(se,{className:"w-auto p-0",align:"start",children:e.jsx(ae,{mode:"single",selected:n,onSelect:C,initialFocus:!0})})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{htmlFor:"category",children:"Category"}),e.jsx(T,{id:"category",placeholder:"e.g., Infrastructure, Compliance, Security",value:l.category,onChange:a=>r(t=>({...t,category:a.target.value}))})]})]}),e.jsxs(te,{children:[e.jsx(x,{type:"button",variant:"outline",onClick:b,children:"Cancel"}),e.jsxs(x,{type:"submit",disabled:p,children:[p&&e.jsx(U,{className:"mr-2 h-4 w-4 animate-spin"}),"Create Task"]})]})]})]})})}function oe(){const[m,w]=i.useState(""),[c,p]=i.useState([]),[k,f]=i.useState(!0),[o,n]=i.useState(null),[C,l]=i.useState(!1);i.useEffect(()=>{y()},[]);const r=c.filter(s=>{var P,_,F;return((P=s.title)==null?void 0:P.toLowerCase().includes(m.toLowerCase()))||((_=s.description)==null?void 0:_.toLowerCase().includes(m.toLowerCase()))||((F=s.assigned_to)==null?void 0:F.toLowerCase().includes(m.toLowerCase()))});if(k)return e.jsx("div",{className:"flex items-center justify-center min-h-96",children:e.jsx(le,{size:"lg"})});const b=s=>{switch(s==null?void 0:s.toLowerCase()){case"open":return"destructive";case"in progress":return"secondary";case"completed":return"default";default:return"outline"}},S=s=>{switch(s==null?void 0:s.toLowerCase()){case"high":return"destructive";case"medium":return"secondary";case"low":return"outline";default:return"outline"}},a=()=>{console.log("New Task clicked - Opening task creation dialog"),l(!0)},t=()=>{console.log("Task created successfully - refreshing tasks list"),y()},y=async()=>{try{f(!0);const s=await A.getAll();p(s.items||[]),n(null)}catch(s){n(s.message||"Failed to fetch tasks"),console.error("Error fetching tasks:",s),p([])}finally{f(!1)}},d=()=>{console.log("View Calendar clicked - Opening calendar view"),alert("Calendar view functionality coming soon - would show tasks in calendar format")},R=()=>{console.log("Filters clicked - Opening filters dialog"),alert("Task filters functionality coming soon - would open a filters panel")},H=s=>{console.log("View Details clicked for task:",s),alert(`Task details view coming soon - would show detailed view for task ${s}`)};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-bold tracking-tight flex items-center gap-2",children:[e.jsx(h,{className:"h-8 w-8"}),"Task Management"]}),e.jsx("p",{className:"text-muted-foreground",children:"Track and manage security and compliance tasks"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(x,{variant:"outline",size:"sm",onClick:d,children:[e.jsx(D,{className:"h-4 w-4 mr-2"}),"View Calendar"]}),e.jsxs(x,{onClick:a,children:[e.jsx(L,{className:"h-4 w-4 mr-2"}),"New Task"]})]})]}),e.jsxs("div",{className:"flex gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsx(T,{placeholder:"Search tasks...",value:m,onChange:s=>w(s.target.value),className:"max-w-sm"})}),e.jsxs(x,{variant:"outline",size:"sm",onClick:R,children:[e.jsx(B,{className:"h-4 w-4 mr-2"}),"Filters"]})]}),o&&e.jsx(g,{className:"border-destructive",children:e.jsxs(j,{className:"pt-6",children:[e.jsxs("p",{className:"text-destructive",children:["Error: ",o]}),e.jsx("p",{className:"text-sm text-muted-foreground mt-2",children:"Showing demo data while backend is unavailable."})]})}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-4",children:[e.jsxs(g,{children:[e.jsxs(v,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(N,{className:"text-sm font-medium",children:"Total Tasks"}),e.jsx(h,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(j,{children:[e.jsx("div",{className:"text-2xl font-bold",children:c.length}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Active tasks in system"})]})]}),e.jsxs(g,{children:[e.jsxs(v,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(N,{className:"text-sm font-medium",children:"Open Tasks"}),e.jsx(h,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(j,{children:[e.jsx("div",{className:"text-2xl font-bold",children:c.filter(s=>s.status==="Open").length}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Require attention"})]})]}),e.jsxs(g,{children:[e.jsxs(v,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(N,{className:"text-sm font-medium",children:"In Progress"}),e.jsx(h,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(j,{children:[e.jsx("div",{className:"text-2xl font-bold",children:c.filter(s=>s.status==="In Progress").length}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Currently being worked on"})]})]}),e.jsxs(g,{children:[e.jsxs(v,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(N,{className:"text-sm font-medium",children:"Completed"}),e.jsx(h,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(j,{children:[e.jsx("div",{className:"text-2xl font-bold",children:c.filter(s=>s.status==="Completed").length}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Successfully finished"})]})]})]}),e.jsxs(g,{children:[e.jsxs(v,{children:[e.jsxs(N,{children:["Tasks (",r.length,")"]}),e.jsx(re,{children:"Manage your security and compliance tasks"})]}),e.jsx(j,{children:r.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(h,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No tasks found"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:m?"Try adjusting your search criteria":"Get started by creating your first task"}),e.jsxs(x,{onClick:a,children:[e.jsx(L,{className:"h-4 w-4 mr-2"}),"Create Task"]})]}):e.jsx("div",{className:"space-y-4",children:r.map(s=>e.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg hover:bg-muted/50 transition-colors cursor-pointer",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("h3",{className:"font-semibold",children:s.title}),e.jsx(M,{variant:b(s.status),children:s.status||"Unknown"}),e.jsxs(M,{variant:S(s.priority),children:[s.priority||"Unknown"," Priority"]})]}),e.jsx("p",{className:"text-sm text-muted-foreground mb-1",children:s.description||"No description available"}),e.jsxs("div",{className:"flex items-center gap-4 text-xs text-muted-foreground",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx($,{className:"h-3 w-3"}),s.assigned_to||"Unassigned"]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(D,{className:"h-3 w-3"}),"Due: ",s.due_date||"No due date"]}),s.created&&e.jsxs("span",{children:["Created: ",new Date(s.created).toLocaleDateString()]})]})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx(x,{variant:"ghost",size:"sm",onClick:()=>H(s.id),children:"View Details"})})]},s.id))})})]}),e.jsx(ce,{open:C,onOpenChange:l,onTaskCreated:t})]})}const he=Object.freeze(Object.defineProperty({__proto__:null,default:oe},Symbol.toStringTag,{value:"Module"}));function de(){return e.jsxs("div",{className:"space-y-6",children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Task Details"}),e.jsx("p",{children:"Task details page - Coming soon"})]})}const ge=Object.freeze(Object.defineProperty({__proto__:null,default:de},Symbol.toStringTag,{value:"Module"}));export{he as T,ge as a};
