import{r as u,j as e,a5 as D,Z as p,a6 as v,G as R,a4 as L,a7 as O,a8 as W,a9 as B,aa as $,E as U,a2 as C,ab as G,a3 as K,K as Z,a0 as Q}from"./react-vendor-B391mDFM.js";import{g as H,h as E,i as q,B as o,C as t,b as a,c as i,a as r,d as h,e as x,j as S,P as N,L as Y}from"./assessments-CKARqxWC.js";import{a as y}from"./vendor-BAj2-sgi.js";import{b as X}from"./utils-vendor-D-EuUvUy.js";const ee=async(s,d)=>{var l,m;try{const n=await H.login(s,d);return te(n.access_token),y.set("refresh_token",n.refresh_token,{expires:7}),J(n.user),n}catch(n){throw console.error("Login error:",n),new Error(((m=(l=n.response)==null?void 0:l.data)==null?void 0:m.detail)||"Invalid email or password")}},I=()=>!!se(),se=()=>y.get("access_token")||null,te=s=>{y.set("access_token",s,{expires:1})},_=()=>{y.remove("access_token"),y.remove("refresh_token")},re=()=>{const s=localStorage.getItem("user");if(s)try{return JSON.parse(s)}catch{return null}return null},J=s=>{localStorage.setItem("user",JSON.stringify(s))},M=()=>{localStorage.removeItem("user")},F=async()=>{try{const s=await H.getCurrentUser();return s?(J(s),s):null}catch(s){return console.error("Failed to refresh user data:",s),null}},ge=(s,d)=>{if(!s)return!1;const[l,m]=d.split("_");return!l||!m?!1:s.roles&&s.roles.length>0?s.roles.some(n=>{if(n.permissions&&n.permissions[l]){const j=n.permissions[l];return Array.isArray(j)&&j.includes(m)}return!1}):!1},ae=(s,d)=>s&&s.roles&&s.roles.length>0?s.roles.some(l=>l.name.toLowerCase()===d.toLowerCase()):!1,pe=ee,V=u.createContext(void 0),ie=()=>{const s=u.useContext(V);if(s===void 0)throw new Error("useAuth must be used within an AuthProvider");return s},Ne=({children:s})=>{const[d,l]=u.useState(null),[m,n]=u.useState(!0);u.useEffect(()=>{(async()=>{try{if(I()){const g=await F();l(g)}else{const g=re();g&&!I()?(M(),_()):l(g)}}catch(g){console.error("Auth initialization error:",g),M(),_()}finally{n(!1)}})()},[]);const j=f=>{l(f)},b=()=>{l(null),_(),M(),window.location.href="/login"},T=async()=>{try{const f=await F();l(f)}catch(f){console.error("Error refreshing user:",f),b()}},w={user:d,isLoading:m,isLoggedIn:!!d&&I(),login:j,logout:b,refreshUser:T};return e.jsx(V.Provider,{value:w,children:s})},le=X("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),A=u.forwardRef(({className:s,variant:d,...l},m)=>e.jsx("div",{ref:m,role:"alert",className:E(le({variant:d}),s),...l}));A.displayName="Alert";const ne=u.forwardRef(({className:s,...d},l)=>e.jsx("h5",{ref:l,className:E("mb-1 font-medium leading-none tracking-tight",s),...d}));ne.displayName="AlertTitle";const P=u.forwardRef(({className:s,...d},l)=>e.jsx("div",{ref:l,className:E("text-sm [&_p]:leading-relaxed",s),...d}));P.displayName="AlertDescription";const ce={assets:{total:45,critical:8},risks:{total:23,high_priority:8},tasks:{open:13,overdue:4},assessments:{active:3,completed:4}};function de(){const{user:s}=ie(),{data:d,isLoading:l,error:m}=D({queryKey:["dashboard","overview"],queryFn:S.getOverview,retry:1,retryDelay:1e3});if(l)return e.jsx(q,{});const n=m?ce:d,j=!!m;return e.jsxs("div",{className:"space-y-6",children:[j&&e.jsxs(A,{children:[e.jsx(p,{className:"h-4 w-4"}),e.jsx(P,{children:"Using demo data. Backend API is not available. Dashboard functionality restored!"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Dashboard"}),e.jsxs("p",{className:"text-muted-foreground",children:["Welcome back, ",(s==null?void 0:s.full_name)||"User",". Here's your security posture overview."]})]}),e.jsxs("div",{className:"flex gap-2",children:[s&&ae(s,"admin")&&e.jsx(o,{variant:"outline",asChild:!0,children:e.jsxs("a",{href:"/dashboard/ciso",children:[e.jsx(v,{className:"w-4 h-4 mr-2"}),"CISO Cockpit"]})}),e.jsx(o,{variant:"outline",asChild:!0,children:e.jsxs("a",{href:"/dashboard/analyst",children:[e.jsx(R,{className:"w-4 h-4 mr-2"}),"Analyst Workbench"]})})]})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[e.jsxs(t,{children:[e.jsxs(a,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(i,{className:"text-sm font-medium",children:"Total Assets"}),e.jsx(L,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(r,{children:[e.jsx("div",{className:"text-2xl font-bold",children:n.assets.total}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[e.jsx("span",{className:"text-red-600",children:n.assets.critical})," critical assets"]})]})]}),e.jsxs(t,{children:[e.jsxs(a,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(i,{className:"text-sm font-medium",children:"Active Risks"}),e.jsx(p,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(r,{children:[e.jsx("div",{className:"text-2xl font-bold",children:n.risks.total}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[e.jsx("span",{className:"text-red-600",children:n.risks.high_priority})," high priority"]})]})]}),e.jsxs(t,{children:[e.jsxs(a,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(i,{className:"text-sm font-medium",children:"Open Tasks"}),e.jsx(O,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(r,{children:[e.jsx("div",{className:"text-2xl font-bold",children:n.tasks.open}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[e.jsx("span",{className:"text-orange-600",children:n.tasks.overdue})," overdue"]})]})]}),e.jsxs(t,{children:[e.jsxs(a,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(i,{className:"text-sm font-medium",children:"Assessments"}),e.jsx(R,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(r,{children:[e.jsx("div",{className:"text-2xl font-bold",children:n.assessments.completed}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[n.assessments.active," in progress"]})]})]})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:[e.jsxs(t,{className:"md:col-span-2",children:[e.jsxs(a,{children:[e.jsx(i,{children:"Risk Posture Trend"}),e.jsx(h,{children:"Your organization's risk posture over the last 6 months"})]}),e.jsx(r,{children:e.jsx("div",{className:"h-[200px] flex items-center justify-center text-muted-foreground",children:e.jsxs("div",{className:"text-center",children:[e.jsx(v,{className:"h-12 w-12 mx-auto mb-2 opacity-50"}),e.jsx("p",{children:"Risk trend chart will be displayed here"}),e.jsx("p",{className:"text-sm",children:"Connect to view detailed analytics"})]})})})]}),e.jsxs(t,{children:[e.jsxs(a,{children:[e.jsx(i,{children:"Recent Alerts"}),e.jsx(h,{children:"Latest security alerts and findings"})]}),e.jsxs(r,{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 bg-red-500 rounded-full"}),e.jsx("span",{className:"text-sm",children:"Critical vulnerability detected"})]}),e.jsx(x,{variant:"destructive",className:"text-xs",children:"New"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 bg-orange-500 rounded-full"}),e.jsx("span",{className:"text-sm",children:"Task overdue: Firewall review"})]}),e.jsx(x,{variant:"secondary",className:"text-xs",children:"2d"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),e.jsx("span",{className:"text-sm",children:"Assessment completed"})]}),e.jsx(x,{variant:"secondary",className:"text-xs",children:"1w"})]}),e.jsx(o,{variant:"outline",className:"w-full mt-4",size:"sm",children:"View All Alerts"})]})]})]}),e.jsxs(t,{children:[e.jsxs(a,{children:[e.jsx(i,{children:"Quick Actions"}),e.jsx(h,{children:"Common tasks and quick access to key features"})]}),e.jsx(r,{children:e.jsxs("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[e.jsx(o,{variant:"outline",className:"h-20 flex-col",asChild:!0,children:e.jsxs("a",{href:"/assets",children:[e.jsx(L,{className:"h-6 w-6 mb-2"}),e.jsx("span",{children:"Manage Assets"})]})}),e.jsx(o,{variant:"outline",className:"h-20 flex-col",asChild:!0,children:e.jsxs("a",{href:"/risks",children:[e.jsx(p,{className:"h-6 w-6 mb-2"}),e.jsx("span",{children:"Review Risks"})]})}),e.jsx(o,{variant:"outline",className:"h-20 flex-col",asChild:!0,children:e.jsxs("a",{href:"/assessments",children:[e.jsx(R,{className:"h-6 w-6 mb-2"}),e.jsx("span",{children:"New Assessment"})]})}),e.jsx(o,{variant:"outline",className:"h-20 flex-col",asChild:!0,children:e.jsxs("a",{href:"/reports",children:[e.jsx(v,{className:"h-6 w-6 mb-2"}),e.jsx("span",{children:"Generate Report"})]})})]})})]})]})}const ve=Object.freeze(Object.defineProperty({__proto__:null,default:de},Symbol.toStringTag,{value:"Module"}));function xe(){const{data:s,isLoading:d,error:l}=D({queryKey:["dashboard","ciso-cockpit"],queryFn:S.getCisoCockpit});return d?e.jsx(q,{}):l?e.jsx("div",{className:"p-6",children:e.jsxs(A,{variant:"destructive",children:[e.jsx(p,{className:"h-4 w-4"}),e.jsx(P,{children:"Failed to load CISO dashboard data. Please try refreshing the page."})]})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-bold tracking-tight flex items-center gap-2",children:[e.jsx(W,{className:"h-8 w-8"}),"CISO Cockpit"]}),e.jsx("p",{className:"text-muted-foreground",children:"Executive-level security posture and strategic risk insights"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(o,{variant:"outline",children:[e.jsx(v,{className:"w-4 h-4 mr-2"}),"Generate Executive Report"]}),e.jsx(o,{children:"Export Dashboard"})]})]}),e.jsxs(t,{className:"border-2 border-primary/20",children:[e.jsxs(a,{children:[e.jsxs(i,{className:"flex items-center gap-2",children:[e.jsx(B,{className:"h-5 w-5"}),"Executive Summary"]}),e.jsx(h,{children:"High-level security posture overview for executive reporting"})]}),e.jsxs(r,{children:[e.jsxs("div",{className:"grid gap-4 md:grid-cols-3",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Overall Risk Level"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(x,{variant:"secondary",className:"bg-yellow-100 text-yellow-800",children:"MEDIUM"}),e.jsx("span",{className:"text-2xl font-bold",children:"7.2/10"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Compliance Posture"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(N,{value:78,className:"flex-1"}),e.jsx("span",{className:"text-2xl font-bold",children:"78%"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Active Threats"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(p,{className:"h-5 w-5 text-red-500"}),e.jsx("span",{className:"text-2xl font-bold text-red-600",children:"5"}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"High Priority"})]})]})]}),e.jsx("div",{className:"mt-4 p-4 bg-muted rounded-lg",children:e.jsxs("p",{className:"text-sm leading-relaxed",children:[e.jsx("strong",{children:"Executive Summary:"})," The organization maintains a moderate risk posture with 78% compliance across implemented frameworks. Five high-priority risks require immediate executive attention, primarily related to third-party vendor assessments and cloud infrastructure security. Investment in automated security controls and threat detection capabilities is recommended for Q2."]})})]})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[e.jsxs(t,{children:[e.jsx(a,{className:"pb-2",children:e.jsx(i,{className:"text-sm font-medium",children:"Security Investment ROI"})}),e.jsxs(r,{children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:"245%"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Risk reduction vs. investment"})]})]}),e.jsxs(t,{children:[e.jsx(a,{className:"pb-2",children:e.jsx(i,{className:"text-sm font-medium",children:"Time to Remediation"})}),e.jsxs(r,{children:[e.jsx("div",{className:"text-2xl font-bold",children:"12.5 days"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Average critical risk resolution"})]})]}),e.jsxs(t,{children:[e.jsx(a,{className:"pb-2",children:e.jsx(i,{className:"text-sm font-medium",children:"Audit Readiness"})}),e.jsxs(r,{children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:"92%"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Controls with evidence"})]})]}),e.jsxs(t,{children:[e.jsx(a,{className:"pb-2",children:e.jsx(i,{className:"text-sm font-medium",children:"Threat Exposure"})}),e.jsxs(r,{children:[e.jsx("div",{className:"text-2xl font-bold text-yellow-600",children:"Medium"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"External attack surface"})]})]})]}),e.jsxs("div",{className:"grid gap-4 lg:grid-cols-2",children:[e.jsxs(t,{children:[e.jsxs(a,{children:[e.jsx(i,{children:"Risk Posture Trend"}),e.jsx(h,{children:"6-month risk level progression"})]}),e.jsx(r,{children:e.jsx("div",{className:"h-[300px] flex items-center justify-center text-muted-foreground",children:e.jsxs("div",{className:"text-center",children:[e.jsx(v,{className:"h-16 w-16 mx-auto mb-4 opacity-50"}),e.jsx("p",{className:"text-lg font-medium",children:"Risk Trend Visualization"}),e.jsx("p",{className:"text-sm",children:"Interactive chart showing risk reduction over time"}),e.jsxs("div",{className:"mt-4 space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"Jan 2025:"}),e.jsx(x,{variant:"destructive",children:"High"})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"Current:"}),e.jsx(x,{variant:"secondary",children:"Medium"})]})]})]})})})]}),e.jsxs(t,{children:[e.jsxs(a,{children:[e.jsx(i,{children:"Compliance Framework Maturity"}),e.jsx(h,{children:"Implementation status across frameworks"})]}),e.jsxs(r,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between text-sm mb-2",children:[e.jsx("span",{className:"font-medium",children:"NIST Cybersecurity Framework"}),e.jsx("span",{className:"text-muted-foreground",children:"82%"})]}),e.jsx(N,{value:82,className:"h-2"})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between text-sm mb-2",children:[e.jsx("span",{className:"font-medium",children:"CIS Controls v8.0"}),e.jsx("span",{className:"text-muted-foreground",children:"74%"})]}),e.jsx(N,{value:74,className:"h-2"})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between text-sm mb-2",children:[e.jsx("span",{className:"font-medium",children:"ISO 27001:2022"}),e.jsx("span",{className:"text-muted-foreground",children:"68%"})]}),e.jsx(N,{value:68,className:"h-2"})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between text-sm mb-2",children:[e.jsx("span",{className:"font-medium",children:"SOC 2 Type II"}),e.jsx("span",{className:"text-muted-foreground",children:"91%"})]}),e.jsx(N,{value:91,className:"h-2"})]})]})]})]}),e.jsxs(t,{children:[e.jsxs(a,{children:[e.jsx(i,{children:"Strategic Risk Portfolio"}),e.jsx(h,{children:"Top business-impacting risks requiring executive attention"})]}),e.jsx(r,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-semibold",children:"Third-Party Vendor Risk"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Inadequate security assessments of critical suppliers"})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(x,{variant:"destructive",children:"Critical"}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-sm font-medium",children:"$2.1M"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Potential Impact"})]})]})]}),e.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-semibold",children:"Cloud Infrastructure Exposure"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Misconfigured cloud services with public access"})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(x,{variant:"destructive",children:"High"}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-sm font-medium",children:"$850K"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Potential Impact"})]})]})]}),e.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-semibold",children:"Data Privacy Compliance Gap"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"GDPR/CCPA compliance requirements not fully implemented"})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(x,{className:"bg-orange-100 text-orange-800",children:"High"}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-sm font-medium",children:"$1.2M"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Potential Impact"})]})]})]})]})})]})]})}const ye=Object.freeze(Object.defineProperty({__proto__:null,default:xe},Symbol.toStringTag,{value:"Module"}));function oe(){const{data:s,isLoading:d,error:l}=D({queryKey:["dashboard","analyst-workbench"],queryFn:S.getAnalystWorkbench});return d?e.jsx(q,{}):l?e.jsx("div",{className:"p-6",children:e.jsxs(A,{variant:"destructive",children:[e.jsx(p,{className:"h-4 w-4"}),e.jsx(P,{children:"Failed to load analyst workbench data. Please try refreshing the page."})]})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-bold tracking-tight flex items-center gap-2",children:[e.jsx($,{className:"h-8 w-8"}),"Analyst Workbench"]}),e.jsx("p",{className:"text-muted-foreground",children:"Your tactical workload manager and assessment center"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(o,{variant:"outline",children:[e.jsx(U,{className:"w-4 h-4 mr-2"}),"Schedule Assessment"]}),e.jsxs(o,{children:[e.jsx(O,{className:"w-4 h-4 mr-2"}),"New Task"]})]})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-4",children:[e.jsxs(t,{children:[e.jsx(a,{className:"pb-2",children:e.jsx(i,{className:"text-sm font-medium",children:"My Open Tasks"})}),e.jsxs(r,{children:[e.jsx("div",{className:"text-2xl font-bold",children:"8"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"2 due today"})]})]}),e.jsxs(t,{children:[e.jsx(a,{className:"pb-2",children:e.jsx(i,{className:"text-sm font-medium",children:"Overdue Items"})}),e.jsxs(r,{children:[e.jsx("div",{className:"text-2xl font-bold text-red-600",children:"3"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Require immediate attention"})]})]}),e.jsxs(t,{children:[e.jsx(a,{className:"pb-2",children:e.jsx(i,{className:"text-sm font-medium",children:"Pending Reviews"})}),e.jsxs(r,{children:[e.jsx("div",{className:"text-2xl font-bold text-orange-600",children:"5"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Awaiting your review"})]})]}),e.jsxs(t,{children:[e.jsx(a,{className:"pb-2",children:e.jsx(i,{className:"text-sm font-medium",children:"This Week's Progress"})}),e.jsxs(r,{children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:"73%"}),e.jsx(N,{value:73,className:"mt-2"})]})]})]}),e.jsxs("div",{className:"grid gap-4 lg:grid-cols-3",children:[e.jsxs(t,{children:[e.jsxs(a,{children:[e.jsxs(i,{className:"flex items-center gap-2",children:[e.jsx(O,{className:"h-5 w-5"}),"My Open Tasks"]}),e.jsx(h,{children:"Tasks assigned to you"})]}),e.jsxs(r,{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-medium text-sm",children:"Review firewall configuration"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Due: Today"})]}),e.jsx(x,{variant:"destructive",className:"text-xs",children:"Critical"})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-medium text-sm",children:"Complete NIST assessment"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Due: Tomorrow"})]}),e.jsx(x,{className:"bg-orange-100 text-orange-800 text-xs",children:"High"})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-medium text-sm",children:"Update risk register"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Due: Friday"})]}),e.jsx(x,{variant:"secondary",className:"text-xs",children:"Medium"})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-medium text-sm",children:"Evidence review - IAM controls"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Due: Next week"})]}),e.jsx(x,{variant:"secondary",className:"text-xs",children:"Medium"})]}),e.jsx(o,{variant:"outline",className:"w-full",size:"sm",children:"View All Tasks"})]})]}),e.jsxs(t,{children:[e.jsxs(a,{children:[e.jsxs(i,{className:"flex items-center gap-2",children:[e.jsx(U,{className:"h-5 w-5"}),"Upcoming Assessments"]}),e.jsx(h,{children:"Scheduled assessment activities"})]}),e.jsxs(r,{className:"space-y-3",children:[e.jsxs("div",{className:"p-3 border rounded-lg",children:[e.jsx("p",{className:"font-medium text-sm",children:"HR Systems - NIST CSF"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Scheduled: July 15, 2025"}),e.jsx("p",{className:"text-xs text-blue-600",children:"In Progress (65% complete)"}),e.jsx(N,{value:65,className:"mt-2 h-1"})]}),e.jsxs("div",{className:"p-3 border rounded-lg",children:[e.jsx("p",{className:"font-medium text-sm",children:"Production Network - CIS Controls"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Scheduled: July 20, 2025"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Status: Draft"})]}),e.jsxs("div",{className:"p-3 border rounded-lg",children:[e.jsx("p",{className:"font-medium text-sm",children:"Cloud Infrastructure - SOC 2"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Scheduled: July 25, 2025"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Status: Planning"})]}),e.jsx(o,{variant:"outline",className:"w-full",size:"sm",children:"View Assessment Calendar"})]})]}),e.jsxs(t,{children:[e.jsxs(a,{children:[e.jsxs(i,{className:"flex items-center gap-2",children:[e.jsx(p,{className:"h-5 w-5"}),"Recent High-Risk Findings"]}),e.jsx(h,{children:"Latest critical findings from integrations"})]}),e.jsxs(r,{className:"space-y-3",children:[e.jsxs("div",{className:"p-3 border rounded-lg border-red-200",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("div",{className:"w-2 h-2 bg-red-500 rounded-full"}),e.jsx("p",{className:"font-medium text-sm",children:"CVE-2024-1234"}),e.jsx(x,{variant:"destructive",className:"text-xs",children:"Critical"})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Remote code execution in web server"}),e.jsx("p",{className:"text-xs text-blue-600",children:"Detected 2 hours ago"})]}),e.jsxs("div",{className:"p-3 border rounded-lg border-orange-200",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("div",{className:"w-2 h-2 bg-orange-500 rounded-full"}),e.jsx("p",{className:"font-medium text-sm",children:"Unauthorized access attempt"}),e.jsx(x,{className:"bg-orange-100 text-orange-800 text-xs",children:"High"})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Multiple failed login attempts detected"}),e.jsx("p",{className:"text-xs text-blue-600",children:"Detected 1 day ago"})]}),e.jsxs("div",{className:"p-3 border rounded-lg border-orange-200",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("div",{className:"w-2 h-2 bg-orange-500 rounded-full"}),e.jsx("p",{className:"font-medium text-sm",children:"Misconfigured S3 bucket"}),e.jsx(x,{className:"bg-orange-100 text-orange-800 text-xs",children:"High"})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Public read access enabled"}),e.jsx("p",{className:"text-xs text-blue-600",children:"Detected 2 days ago"})]}),e.jsx(o,{variant:"outline",className:"w-full",size:"sm",children:"View All Findings"})]})]})]}),e.jsxs(t,{children:[e.jsxs(a,{children:[e.jsxs(i,{className:"flex items-center gap-2",children:[e.jsx(C,{className:"h-5 w-5"}),"Evidence Awaiting Review"]}),e.jsx(h,{children:"Documents and evidence requiring your analysis"})]}),e.jsx(r,{children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(C,{className:"h-5 w-5 text-muted-foreground"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Password Policy v2.1"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Uploaded by John Smith • 2 days ago"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(x,{variant:"secondary",children:"Policy Document"}),e.jsx(o,{size:"sm",variant:"outline",children:"Review"})]})]}),e.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(C,{className:"h-5 w-5 text-muted-foreground"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Firewall Configuration Screenshot"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Uploaded by Mike Johnson • 1 day ago"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(x,{variant:"secondary",children:"Screenshot"}),e.jsx(o,{size:"sm",variant:"outline",children:"Review"})]})]}),e.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(C,{className:"h-5 w-5 text-muted-foreground"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Security Training Certificate"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Uploaded by Sarah Wilson • 3 hours ago"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(x,{variant:"secondary",children:"Certificate"}),e.jsx(o,{size:"sm",variant:"outline",children:"Review"})]})]})]})})]})]})}const be=Object.freeze(Object.defineProperty({__proto__:null,default:oe},Symbol.toStringTag,{value:"Module"}));function me(){var w,f,g,z;const[s,d]=u.useState(null),[l,m]=u.useState(!0),[n,j]=u.useState(null);if(u.useEffect(()=>{(async()=>{try{m(!0);const k=await S.getSystemOwner();d(k),j(null)}catch(k){j(k.message||"Failed to fetch dashboard data"),console.error("Error fetching dashboard data:",k)}finally{m(!1)}})()},[]),l)return e.jsx("div",{className:"flex items-center justify-center min-h-96",children:e.jsx(Y,{size:"lg"})});const b=c=>{switch(c==null?void 0:c.toLowerCase()){case"high":return"destructive";case"medium":return"secondary";case"low":return"outline";default:return"secondary"}},T=c=>{switch(c==null?void 0:c.toLowerCase()){case"high":return"destructive";case"medium":return"secondary";case"info":return"outline";default:return"secondary"}};return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-bold tracking-tight flex items-center gap-2",children:[e.jsx(G,{className:"h-8 w-8"}),"System Owner Inbox"]}),e.jsx("p",{className:"text-muted-foreground",children:"Manage your assets, approvals, and system ownership responsibilities"})]})}),n&&e.jsx(t,{className:"border-destructive",children:e.jsxs(r,{className:"pt-6",children:[e.jsxs("p",{className:"text-destructive",children:["Error: ",n]}),e.jsx("p",{className:"text-sm text-muted-foreground mt-2",children:"Showing example data while backend is unavailable."})]})}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-4",children:[e.jsxs(t,{children:[e.jsxs(a,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(i,{className:"text-sm font-medium",children:"Pending Approvals"}),e.jsx(K,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(r,{children:[e.jsx("div",{className:"text-2xl font-bold",children:((w=s==null?void 0:s.metrics)==null?void 0:w.pending_approvals)||8}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Awaiting your action"})]})]}),e.jsxs(t,{children:[e.jsxs(a,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(i,{className:"text-sm font-medium",children:"Completed This Week"}),e.jsx(Z,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(r,{children:[e.jsx("div",{className:"text-2xl font-bold",children:((f=s==null?void 0:s.metrics)==null?void 0:f.completed_this_week)||15}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Tasks completed"})]})]}),e.jsxs(t,{children:[e.jsxs(a,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(i,{className:"text-sm font-medium",children:"Overdue Tasks"}),e.jsx(p,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(r,{children:[e.jsx("div",{className:"text-2xl font-bold",children:((g=s==null?void 0:s.metrics)==null?void 0:g.overdue_tasks)||2}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Need immediate attention"})]})]}),e.jsxs(t,{children:[e.jsxs(a,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(i,{className:"text-sm font-medium",children:"My Assets"}),e.jsx(Q,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(r,{children:[e.jsx("div",{className:"text-2xl font-bold",children:((z=s==null?void 0:s.my_assets)==null?void 0:z.total_assets)||12}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Assets under my ownership"})]})]})]}),e.jsxs("div",{className:"grid gap-6 md:grid-cols-2",children:[e.jsxs(t,{children:[e.jsxs(a,{children:[e.jsx(i,{children:"Pending Tasks"}),e.jsx(h,{children:"Items requiring your attention or approval"})]}),e.jsx(r,{children:e.jsx("div",{className:"space-y-4",children:((s==null?void 0:s.pending_tasks)||[{id:1,title:"Review Access Request - John Doe",type:"Access Request",priority:"Medium",due_date:"2025-08-06",requestor:"HR Department"},{id:2,title:"Approve Security Policy Update",type:"Policy Review",priority:"High",due_date:"2025-08-05",requestor:"Security Team"},{id:3,title:"Asset Classification Review",type:"Asset Management",priority:"Low",due_date:"2025-08-10",requestor:"IT Operations"}]).map(c=>e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("h4",{className:"font-medium",children:c.title}),e.jsx(x,{variant:b(c.priority),children:c.priority})]}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[c.type," • Due: ",c.due_date," • From: ",c.requestor]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(o,{variant:"outline",size:"sm",children:"Review"}),e.jsx(o,{size:"sm",children:"Approve"})]})]},c.id))})})]}),e.jsxs(t,{children:[e.jsxs(a,{children:[e.jsx(i,{children:"Recent Notifications"}),e.jsx(h,{children:"Latest system alerts and updates"})]}),e.jsx(r,{children:e.jsx("div",{className:"space-y-4",children:((s==null?void 0:s.notifications)||[{id:1,message:"New vulnerability detected in production systems",type:"Security Alert",timestamp:"2025-08-04T17:30:00Z",severity:"High"},{id:2,message:"Compliance audit scheduled for next week",type:"Compliance",timestamp:"2025-08-04T15:20:00Z",severity:"Medium"},{id:3,message:"Monthly risk assessment completed",type:"Risk Management",timestamp:"2025-08-04T10:45:00Z",severity:"Info"}]).map(c=>e.jsxs("div",{className:"flex items-start gap-3 p-3 border rounded-lg",children:[e.jsx(p,{className:"h-4 w-4 mt-0.5 text-muted-foreground"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("p",{className:"text-sm font-medium",children:c.message}),e.jsx(x,{variant:T(c.severity),children:c.severity})]}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[c.type," • ",new Date(c.timestamp).toLocaleString()]})]})]},c.id))})})]})]})]})}const we=Object.freeze(Object.defineProperty({__proto__:null,default:me},Symbol.toStringTag,{value:"Module"}));export{A,ye as C,ve as D,we as S,ge as a,P as b,Ne as c,be as d,ae as h,pe as l,ie as u};
