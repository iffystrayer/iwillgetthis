import{j as e,L as te,r as n,S as Le,R as ae,a as re,I as Fe,b as Ie,P as Ge,C as ne,c as Be,X as Ue,T as ie,D as oe,O as le,d as Ve,V as Me,e as de,f as qe,g as ce,h as He,i as me,k as Je,l as xe,m as Ke,n as Qe,o as We,p as ue,q as Xe,s as he,t as fe,u as pe,v as Ye,w as Ze,x as es,y as ss,z as ts,A as as,B as ge,E as M,F as je,G as T,H as W,J as rs,K as L,M as ns,N as ve,Q as ye,U as Ne,W as is,Y as $,Z as O,_ as os,$ as ls,a0 as ds,a1 as cs,a2 as X,a3 as Y}from"./react-vendor-B391mDFM.js";import{a as we,t as ms,c as xs,b as q}from"./utils-vendor-D-EuUvUy.js";import{a as k,f as Z}from"./vendor-BAj2-sgi.js";const C=we.create({baseURL:"http://localhost:30641/api/v1",timeout:3e4,headers:{"Content-Type":"application/json"}});C.interceptors.request.use(s=>{const t=k.get("access_token");return t&&(s.headers.Authorization=`Bearer ${t}`),s},s=>Promise.reject(s));C.interceptors.response.use(s=>s,async s=>{var a;const t=s.config;if(((a=s.response)==null?void 0:a.status)===401&&t){const o=k.get("refresh_token");if(o)try{const h=(await we.post(`${C.defaults.baseURL}/auth/refresh`,{refresh_token:o})).data;return k.set("access_token",h.access_token,{expires:1}),k.set("refresh_token",h.refresh_token,{expires:7}),t.headers&&(t.headers.Authorization=`Bearer ${h.access_token}`),C(t)}catch(d){return k.remove("access_token"),k.remove("refresh_token"),window.location.href="/login",Promise.reject(d)}else k.remove("access_token"),k.remove("refresh_token"),window.location.href="/login"}return Promise.reject(s)});const r=async(s,t,a,o)=>{try{return(await C({method:s,url:t,data:a,params:o})).data}catch(d){throw console.error(`API ${s} ${t} failed:`,d),d}},Ds={login:async(s,t)=>r("POST","/auth/login",{username:s,password:t}),register:async s=>r("POST","/auth/register",s),logout:async()=>r("POST","/auth/logout"),getCurrentUser:async()=>r("GET","/auth/me"),refreshToken:async s=>r("POST","/auth/refresh",{refresh_token:s})},_s={getAll:s=>r("GET","/assets",void 0,s),getById:s=>r("GET",`/assets/${s}`),create:s=>r("POST","/assets",s),update:(s,t)=>r("PUT",`/assets/${s}`,t),delete:s=>r("DELETE",`/assets/${s}`)},Rs={getAll:s=>r("GET","/tasks",void 0,s),getById:s=>r("GET",`/tasks/${s}`),create:s=>r("POST","/tasks",s),update:(s,t)=>r("PUT",`/tasks/${s}`,t),delete:s=>r("DELETE",`/tasks/${s}`)},H={getAll:s=>r("GET","/assessments",void 0,s),getById:s=>r("GET",`/assessments/${s}`),create:s=>r("POST","/assessments",s),update:(s,t)=>r("PUT",`/assessments/${s}`,t),delete:s=>r("DELETE",`/assessments/${s}`)},$s={getAll:s=>r("GET","/evidence",void 0,s),getById:s=>r("GET",`/evidence/${s}`),create:s=>r("POST","/evidence",s),update:(s,t)=>r("PUT",`/evidence/${s}`,t),delete:s=>r("DELETE",`/evidence/${s}`),upload:async s=>{try{return(await C({method:"POST",url:"/evidence/upload",data:s,headers:{"Content-Type":"multipart/form-data"}})).data}catch(t){throw console.error("Evidence upload failed:",t),t}},download:s=>C({method:"GET",url:`/evidence/${s}/download`,responseType:"blob"})},Os={getAll:s=>r("GET","/reports",void 0,s),getById:s=>r("GET",`/reports/${s}`),generate:s=>r("POST","/reports/generate",s)},Ls={getOverview:()=>r("GET","/dashboards/overview"),getMetrics:()=>r("GET","/dashboards/metrics"),getRecentActivity:()=>r("GET","/dashboards/recent-activity"),getCisoCockpit:()=>r("GET","/dashboards/ciso-cockpit"),getAnalystWorkbench:()=>r("GET","/dashboards/analyst-workbench"),getSystemOwner:()=>r("GET","/dashboards/system-owner")},Fs={getAll:s=>r("GET","/users",void 0,s),getById:s=>r("GET",`/users/${s}`),create:s=>r("POST","/users",s),update:(s,t)=>r("PUT",`/users/${s}`,t),delete:s=>r("DELETE",`/users/${s}`)},Is={getAll:s=>r("GET","/integrations",void 0,s),getById:s=>r("GET",`/integrations/${s}`),create:s=>r("POST","/integrations",s),update:(s,t)=>r("PUT",`/integrations/${s}`,t),delete:s=>r("DELETE",`/integrations/${s}`),sync:s=>r("POST",`/integrations/${s}/sync`),test:s=>r("POST",`/integrations/${s}/test`)},Gs={getProviders:()=>r("GET","/ai/providers"),getProviderStatus:s=>r("GET",`/ai/providers/${s}/status`),getProvidersStatus:()=>r("GET","/ai/providers/status"),getRecommendedProvider:s=>r("GET","/ai/providers/recommended",void 0,{task_type:s}),analyzeEvidence:s=>r("POST","/ai/analyze-evidence",s),analyzeEvidenceEnhanced:s=>r("POST","/ai/analyze-evidence-enhanced",s),generateRisk:s=>r("POST","/ai/generate-risk",s),generateRemediation:s=>r("POST","/ai/generate-remediation",s),generateNarrativeEnhanced:s=>r("POST","/ai/generate-narrative-enhanced",s),testProvider:(s,t)=>r("POST",`/ai/providers/${s}/test`,{message:t}),getAnalytics:()=>r("GET","/ai/analytics"),getUsageSummary:()=>r("GET","/ai/usage-summary")};function i(...s){return ms(xs(s))}const us={sm:"h-4 w-4",md:"h-6 w-6",lg:"h-8 w-8"};function J({size:s="md",className:t}){return e.jsx(te,{className:i("animate-spin",us[s],t)})}function Bs(){return e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsxs("div",{className:"text-center",children:[e.jsx(J,{size:"lg",className:"mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:"Loading..."})]})})}const F=q("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),j=n.forwardRef(({className:s,variant:t,size:a,asChild:o=!1,...d},h)=>{const v=o?Le:"button";return e.jsx(v,{className:i(F({variant:t,size:a,className:s})),ref:h,...d})});j.displayName="Button";const R=n.forwardRef(({className:s,type:t,...a},o)=>e.jsx("input",{type:t,className:i("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",s),ref:o,...a}));R.displayName="Input";const hs=q("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function I({className:s,variant:t,...a}){return e.jsx("div",{className:i(hs({variant:t}),s),...a})}const fs=q("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),z=n.forwardRef(({className:s,...t},a)=>e.jsx(ae,{ref:a,className:i(fs(),s),...t}));z.displayName=ae.displayName;const x=n.forwardRef(({className:s,...t},a)=>e.jsx("div",{ref:a,className:i("rounded-lg border bg-card text-card-foreground shadow-sm",s),...t}));x.displayName="Card";const p=n.forwardRef(({className:s,...t},a)=>e.jsx("div",{ref:a,className:i("flex flex-col space-y-1.5 p-6",s),...t}));p.displayName="CardHeader";const g=n.forwardRef(({className:s,...t},a)=>e.jsx("h3",{ref:a,className:i("text-2xl font-semibold leading-none tracking-tight",s),...t}));g.displayName="CardTitle";const P=n.forwardRef(({className:s,...t},a)=>e.jsx("p",{ref:a,className:i("text-sm text-muted-foreground",s),...t}));P.displayName="CardDescription";const u=n.forwardRef(({className:s,...t},a)=>e.jsx("div",{ref:a,className:i("p-6 pt-0",s),...t}));u.displayName="CardContent";const ps=n.forwardRef(({className:s,...t},a)=>e.jsx("div",{ref:a,className:i("flex items-center p-6 pt-0",s),...t}));ps.displayName="CardFooter";const be=n.forwardRef(({className:s,value:t,...a},o)=>e.jsx(re,{ref:o,className:i("relative h-4 w-full overflow-hidden rounded-full bg-secondary",s),...a,children:e.jsx(Fe,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:`translateX(-${100-(t||0)}%)`}})}));be.displayName=re.displayName;const gs=Ie,js=Ge,ke=n.forwardRef(({className:s,...t},a)=>e.jsx(le,{ref:a,className:i("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",s),...t}));ke.displayName=le.displayName;const ze=n.forwardRef(({className:s,children:t,...a},o)=>e.jsxs(js,{children:[e.jsx(ke,{}),e.jsxs(ne,{ref:o,className:i("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border border-zinc-200 bg-white p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg dark:border-zinc-800 dark:bg-zinc-950",s),...a,children:[t,e.jsxs(Be,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-white transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-zinc-950 focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-zinc-100 data-[state=open]:text-zinc-500 dark:ring-offset-zinc-950 dark:focus:ring-zinc-300 dark:data-[state=open]:bg-zinc-800 dark:data-[state=open]:text-zinc-400",children:[e.jsx(Ue,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));ze.displayName=ne.displayName;const Se=({className:s,...t})=>e.jsx("div",{className:i("flex flex-col space-y-1.5 text-center sm:text-left",s),...t});Se.displayName="DialogHeader";const Te=({className:s,...t})=>e.jsx("div",{className:i("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",s),...t});Te.displayName="DialogFooter";const Ce=n.forwardRef(({className:s,...t},a)=>e.jsx(ie,{ref:a,className:i("text-lg font-semibold leading-none tracking-tight",s),...t}));Ce.displayName=ie.displayName;const Ae=n.forwardRef(({className:s,...t},a)=>e.jsx(oe,{ref:a,className:i("text-sm text-zinc-500 dark:text-zinc-400",s),...t}));Ae.displayName=oe.displayName;const G=n.forwardRef(({className:s,...t},a)=>e.jsx("textarea",{className:i("flex min-h-[60px] w-full rounded-md border border-zinc-200 bg-transparent px-3 py-2 text-base shadow-sm placeholder:text-zinc-500 focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-zinc-950 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm dark:border-zinc-800 dark:placeholder:text-zinc-400 dark:focus-visible:ring-zinc-300",s),ref:a,...t}));G.displayName="Textarea";const ee=Ve,se=Me,B=n.forwardRef(({className:s,children:t,...a},o)=>e.jsxs(de,{ref:o,className:i("flex h-9 w-full items-center justify-between whitespace-nowrap rounded-md border border-zinc-200 bg-transparent px-3 py-2 text-sm shadow-sm ring-offset-white placeholder:text-zinc-500 focus:outline-none focus:ring-1 focus:ring-zinc-950 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1 dark:border-zinc-800 dark:ring-offset-zinc-950 dark:placeholder:text-zinc-400 dark:focus:ring-zinc-300",s),...a,children:[t,e.jsx(qe,{asChild:!0,children:e.jsx(ce,{className:"h-4 w-4 opacity-50"})})]}));B.displayName=de.displayName;const Ee=n.forwardRef(({className:s,...t},a)=>e.jsx(ue,{ref:a,className:i("flex cursor-default items-center justify-center py-1",s),...t,children:e.jsx(Xe,{className:"h-4 w-4"})}));Ee.displayName=ue.displayName;const Pe=n.forwardRef(({className:s,...t},a)=>e.jsx(he,{ref:a,className:i("flex cursor-default items-center justify-center py-1",s),...t,children:e.jsx(ce,{className:"h-4 w-4"})}));Pe.displayName=he.displayName;const U=n.forwardRef(({className:s,children:t,position:a="popper",...o},d)=>e.jsx(He,{children:e.jsxs(me,{ref:d,className:i("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border border-zinc-200 bg-white text-zinc-950 shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 dark:border-zinc-800 dark:bg-zinc-950 dark:text-zinc-50",a==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",s),position:a,...o,children:[e.jsx(Ee,{}),e.jsx(Je,{className:i("p-1",a==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:t}),e.jsx(Pe,{})]})}));U.displayName=me.displayName;const vs=n.forwardRef(({className:s,...t},a)=>e.jsx(fe,{ref:a,className:i("px-2 py-1.5 text-sm font-semibold",s),...t}));vs.displayName=fe.displayName;const V=n.forwardRef(({className:s,children:t,...a},o)=>e.jsxs(xe,{ref:o,className:i("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-2 pr-8 text-sm outline-none focus:bg-zinc-100 focus:text-zinc-900 data-[disabled]:pointer-events-none data-[disabled]:opacity-50 dark:focus:bg-zinc-800 dark:focus:text-zinc-50",s),...a,children:[e.jsx("span",{className:"absolute right-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(Ke,{children:e.jsx(Qe,{className:"h-4 w-4"})})}),e.jsx(We,{children:t})]}));V.displayName=xe.displayName;const ys=n.forwardRef(({className:s,...t},a)=>e.jsx(pe,{ref:a,className:i("-mx-1 my-1 h-px bg-zinc-100 dark:bg-zinc-800",s),...t}));ys.displayName=pe.displayName;function De({className:s,classNames:t,showOutsideDays:a=!0,...o}){return e.jsx(Ye,{showOutsideDays:a,className:i("p-3",s),classNames:{months:"flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0",month:"space-y-4",caption:"flex justify-center pt-1 relative items-center",caption_label:"text-sm font-medium",nav:"space-x-1 flex items-center",nav_button:i(F({variant:"outline"}),"h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100"),nav_button_previous:"absolute left-1",nav_button_next:"absolute right-1",table:"w-full border-collapse space-y-1",head_row:"flex",head_cell:"text-zinc-500 rounded-md w-8 font-normal text-[0.8rem] dark:text-zinc-400",row:"flex w-full mt-2",cell:i("relative p-0 text-center text-sm focus-within:relative focus-within:z-20 [&:has([aria-selected])]:bg-zinc-100 [&:has([aria-selected].day-outside)]:bg-zinc-100/50 [&:has([aria-selected].day-range-end)]:rounded-r-md dark:[&:has([aria-selected])]:bg-zinc-800 dark:[&:has([aria-selected].day-outside)]:bg-zinc-800/50",o.mode==="range"?"[&:has(>.day-range-end)]:rounded-r-md [&:has(>.day-range-start)]:rounded-l-md first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md":"[&:has([aria-selected])]:rounded-md"),day:i(F({variant:"ghost"}),"h-8 w-8 p-0 font-normal aria-selected:opacity-100"),day_range_start:"day-range-start",day_range_end:"day-range-end",day_selected:"bg-zinc-900 text-zinc-50 hover:bg-zinc-900 hover:text-zinc-50 focus:bg-zinc-900 focus:text-zinc-50 dark:bg-zinc-50 dark:text-zinc-900 dark:hover:bg-zinc-50 dark:hover:text-zinc-900 dark:focus:bg-zinc-50 dark:focus:text-zinc-900",day_today:"bg-zinc-100 text-zinc-900 dark:bg-zinc-800 dark:text-zinc-50",day_outside:"day-outside text-zinc-500 aria-selected:bg-zinc-100/50 aria-selected:text-zinc-500 dark:text-zinc-400 dark:aria-selected:bg-zinc-800/50 dark:aria-selected:text-zinc-400",day_disabled:"text-zinc-500 opacity-50 dark:text-zinc-400",day_range_middle:"aria-selected:bg-zinc-100 aria-selected:text-zinc-900 dark:aria-selected:bg-zinc-800 dark:aria-selected:text-zinc-50",day_hidden:"invisible",...t},components:{IconLeft:({className:d,...h})=>e.jsx(es,{className:i("h-4 w-4",d),...h}),IconRight:({className:d,...h})=>e.jsx(Ze,{className:i("h-4 w-4",d),...h})},...o})}De.displayName="Calendar";const Ns=ss,ws=ts,_e=n.forwardRef(({className:s,align:t="center",sideOffset:a=4,...o},d)=>e.jsx(as,{children:e.jsx(ge,{ref:d,align:t,sideOffset:a,className:i("z-50 w-72 rounded-md border border-zinc-200 bg-white p-4 text-zinc-950 shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 dark:border-zinc-800 dark:bg-zinc-950 dark:text-zinc-50",s),...o})}));_e.displayName=ge.displayName;const bs=["NIST Cybersecurity Framework","ISO 27001","SOC 2","PCI DSS","HIPAA","GDPR","COBIT","COSO","Custom Framework"],ks=["Internal Security Assessment","External Security Assessment","Compliance Assessment","Risk Assessment","Penetration Testing","Vulnerability Assessment","Third-Party Assessment"];function zs({open:s,onOpenChange:t,onAssessmentCreated:a}){const[o,d]=n.useState(!1),[h,v]=n.useState(null),[y,S]=n.useState(),[N,m]=n.useState({name:"",description:"",framework:"",type:"",assessor:"",scope:""}),w=()=>{m({name:"",description:"",framework:"",type:"",assessor:"",scope:""}),S(void 0),v(null),t(!1)},D=async c=>{var f,_;if(c.preventDefault(),!N.name.trim()){v("Assessment name is required");return}if(!N.framework){v("Framework selection is required");return}d(!0),v(null);try{const b={...N,due_date:y?Z(y,"yyyy-MM-dd"):null,status:"Planning",progress:0,created_date:new Date().toISOString()};console.log("Creating assessment with data:",b),await H.create(b),console.log("✅ Assessment created successfully"),a&&a(),w()}catch(b){console.error("❌ Failed to create assessment:",b),v(((_=(f=b.response)==null?void 0:f.data)==null?void 0:_.message)||b.message||"Failed to create assessment")}finally{d(!1)}};return e.jsx(gs,{open:s,onOpenChange:t,children:e.jsxs(ze,{className:"sm:max-w-[600px] max-h-[90vh] overflow-y-auto",children:[e.jsxs(Se,{children:[e.jsx(Ce,{children:"Create New Assessment"}),e.jsx(Ae,{children:"Set up a new security or compliance assessment. Fill in the details below to get started."})]}),e.jsxs("form",{onSubmit:D,className:"space-y-6",children:[h&&e.jsx("div",{className:"bg-destructive/15 text-destructive text-sm p-3 rounded-md",children:h}),e.jsxs("div",{className:"grid gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(z,{htmlFor:"name",children:"Assessment Name *"}),e.jsx(R,{id:"name",placeholder:"e.g., Q4 2024 SOC 2 Assessment",value:N.name,onChange:c=>m(f=>({...f,name:c.target.value})),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(z,{htmlFor:"description",children:"Description"}),e.jsx(G,{id:"description",placeholder:"Describe the assessment objectives and scope...",value:N.description,onChange:c=>m(f=>({...f,description:c.target.value})),rows:3})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(z,{htmlFor:"framework",children:"Framework *"}),e.jsxs(ee,{value:N.framework,onValueChange:c=>m(f=>({...f,framework:c})),required:!0,children:[e.jsx(B,{children:e.jsx(se,{placeholder:"Select framework"})}),e.jsx(U,{children:bs.map(c=>e.jsx(V,{value:c,children:c},c))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(z,{htmlFor:"type",children:"Assessment Type"}),e.jsxs(ee,{value:N.type,onValueChange:c=>m(f=>({...f,type:c})),children:[e.jsx(B,{children:e.jsx(se,{placeholder:"Select type"})}),e.jsx(U,{children:ks.map(c=>e.jsx(V,{value:c,children:c},c))})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(z,{htmlFor:"assessor",children:"Lead Assessor"}),e.jsx(R,{id:"assessor",placeholder:"Enter assessor name",value:N.assessor,onChange:c=>m(f=>({...f,assessor:c.target.value}))})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(z,{children:"Due Date"}),e.jsxs(Ns,{children:[e.jsx(ws,{asChild:!0,children:e.jsxs(j,{variant:"outline",className:i("w-full justify-start text-left font-normal",!y&&"text-muted-foreground"),children:[e.jsx(M,{className:"mr-2 h-4 w-4"}),y?Z(y,"PPP"):"Select due date"]})}),e.jsx(_e,{className:"w-auto p-0",align:"start",children:e.jsx(De,{mode:"single",selected:y,onSelect:S,initialFocus:!0})})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(z,{htmlFor:"scope",children:"Scope"}),e.jsx(G,{id:"scope",placeholder:"Define what systems, processes, or areas will be assessed...",value:N.scope,onChange:c=>m(f=>({...f,scope:c.target.value})),rows:2})]})]}),e.jsxs(Te,{children:[e.jsx(j,{type:"button",variant:"outline",onClick:w,children:"Cancel"}),e.jsxs(j,{type:"submit",disabled:o,children:[o&&e.jsx(te,{className:"mr-2 h-4 w-4 animate-spin"}),"Create Assessment"]})]})]})]})})}function Ss(){const s=je(),[t,a]=n.useState(""),[o,d]=n.useState([]),[h,v]=n.useState(!0),[y,S]=n.useState(null),[N,m]=n.useState(!1),w=async()=>{try{v(!0);const l=await H.getAll();d(l.items||[]),S(null)}catch(l){S(l.message||"Failed to fetch assessments"),console.error("Error fetching assessments:",l),d([])}finally{v(!1)}};n.useEffect(()=>{w()},[]);const D=o.filter(l=>{var K,Q;return((K=l.name)==null?void 0:K.toLowerCase().includes(t.toLowerCase()))||((Q=l.framework)==null?void 0:Q.toLowerCase().includes(t.toLowerCase()))});if(h)return e.jsx("div",{className:"flex items-center justify-center min-h-96",children:e.jsx(J,{size:"lg"})});const c=l=>{switch(l==null?void 0:l.toLowerCase()){case"completed":return"default";case"in progress":return"secondary";case"planning":return"outline";case"on hold":return"destructive";default:return"secondary"}},f=()=>{console.log("New Assessment clicked - Opening assessment creation dialog"),m(!0)},_=()=>{console.log("Assessment created successfully - refreshing assessments list"),w()},b=()=>{console.log("Schedule clicked - Opening assessment scheduling dialog"),alert("Schedule functionality would open a scheduling dialog for assessments")},$e=()=>{console.log("Filters clicked - Opening filters dialog"),alert("Filters functionality would open a filters panel for assessments")},Oe=l=>{console.log("View Details clicked for assessment:",l),s(`/assessments/${l}`)};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-bold tracking-tight flex items-center gap-2",children:[e.jsx(T,{className:"h-8 w-8"}),"Security Assessments"]}),e.jsx("p",{className:"text-muted-foreground",children:"Manage security and compliance assessments across frameworks"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(j,{variant:"outline",size:"sm",onClick:b,children:[e.jsx(M,{className:"h-4 w-4 mr-2"}),"Schedule"]}),e.jsxs(j,{onClick:f,children:[e.jsx(W,{className:"h-4 w-4 mr-2"}),"New Assessment"]})]})]}),e.jsxs("div",{className:"flex gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsx(R,{placeholder:"Search assessments...",value:t,onChange:l=>a(l.target.value),className:"max-w-sm"})}),e.jsxs(j,{variant:"outline",size:"sm",onClick:$e,children:[e.jsx(rs,{className:"h-4 w-4 mr-2"}),"Filters"]})]}),y&&e.jsx(x,{className:"border-destructive",children:e.jsxs(u,{className:"pt-6",children:[e.jsxs("p",{className:"text-destructive",children:["Error: ",y]}),e.jsx("p",{className:"text-sm text-muted-foreground mt-2",children:"Showing example data while backend is unavailable."})]})}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-4",children:[e.jsxs(x,{children:[e.jsxs(p,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(g,{className:"text-sm font-medium",children:"Total Assessments"}),e.jsx(T,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(u,{children:[e.jsx("div",{className:"text-2xl font-bold",children:o.length}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Active assessments"})]})]}),e.jsxs(x,{children:[e.jsxs(p,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(g,{className:"text-sm font-medium",children:"In Progress"}),e.jsx(L,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(u,{children:[e.jsx("div",{className:"text-2xl font-bold",children:o.filter(l=>l.status==="In Progress").length}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Currently active"})]})]}),e.jsxs(x,{children:[e.jsxs(p,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(g,{className:"text-sm font-medium",children:"Completed"}),e.jsx(L,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(u,{children:[e.jsx("div",{className:"text-2xl font-bold",children:o.filter(l=>l.status==="Completed").length}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Successfully finished"})]})]}),e.jsxs(x,{children:[e.jsxs(p,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(g,{className:"text-sm font-medium",children:"Frameworks"}),e.jsx(T,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(u,{children:[e.jsx("div",{className:"text-2xl font-bold",children:new Set(o.map(l=>l.framework)).size}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Different frameworks"})]})]})]}),e.jsxs(x,{children:[e.jsxs(p,{children:[e.jsxs(g,{children:["Assessments (",D.length,")"]}),e.jsx(P,{children:"Security and compliance assessments across various frameworks"})]}),e.jsx(u,{children:D.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(T,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No assessments found"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:t?"Try adjusting your search criteria":"Get started by creating your first assessment"}),e.jsxs(j,{onClick:f,children:[e.jsx(W,{className:"h-4 w-4 mr-2"}),"New Assessment"]})]}):e.jsx("div",{className:"space-y-4",children:D.map(l=>e.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg hover:bg-muted/50 transition-colors cursor-pointer",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("h3",{className:"font-semibold",children:l.name}),e.jsx(I,{variant:c(l.status),children:l.status||"Unknown"}),e.jsx(I,{variant:"outline",children:l.framework||"No Framework"})]}),e.jsxs("div",{className:"flex items-center gap-4 text-xs text-muted-foreground",children:[e.jsxs("span",{children:["Progress: ",l.progress||0,"%"]}),e.jsxs("span",{children:["Due: ",l.due_date||"No due date"]}),e.jsxs("span",{children:["Assessor: ",l.assessor||"Unassigned"]})]})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx(j,{variant:"ghost",size:"sm",onClick:()=>Oe(l.id),children:"View Details"})})]},l.id))})})]}),e.jsx(zs,{open:N,onOpenChange:m,onAssessmentCreated:_})]})}const Us=Object.freeze(Object.defineProperty({__proto__:null,default:Ss},Symbol.toStringTag,{value:"Module"})),Ts=ns,Re=n.forwardRef(({className:s,...t},a)=>e.jsx(ve,{ref:a,className:i("inline-flex h-9 items-center justify-center rounded-lg bg-zinc-100 p-1 text-zinc-500 dark:bg-zinc-800 dark:text-zinc-400",s),...t}));Re.displayName=ve.displayName;const A=n.forwardRef(({className:s,...t},a)=>e.jsx(ye,{ref:a,className:i("inline-flex items-center justify-center whitespace-nowrap rounded-md px-3 py-1 text-sm font-medium ring-offset-white transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-zinc-950 focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-white data-[state=active]:text-zinc-950 data-[state=active]:shadow dark:ring-offset-zinc-950 dark:focus-visible:ring-zinc-300 dark:data-[state=active]:bg-zinc-950 dark:data-[state=active]:text-zinc-50",s),...t}));A.displayName=ye.displayName;const E=n.forwardRef(({className:s,...t},a)=>e.jsx(Ne,{ref:a,className:i("mt-2 ring-offset-white focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-zinc-950 focus-visible:ring-offset-2 dark:ring-offset-zinc-950 dark:focus-visible:ring-zinc-300",s),...t}));E.displayName=Ne.displayName;function Cs(){const{id:s}=is(),t=je(),[a,o]=n.useState(null),[d,h]=n.useState(!0),[v,y]=n.useState(null);if(n.useEffect(()=>{(async()=>{if(!s){y("Assessment ID not provided"),h(!1);return}try{h(!0);const w=await H.getById(s);o(w),y(null)}catch(w){y(w.message||"Failed to fetch assessment details"),console.error("Error fetching assessment:",w)}finally{h(!1)}})()},[s]),d)return e.jsx("div",{className:"flex items-center justify-center min-h-96",children:e.jsx(J,{size:"lg"})});if(v)return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex items-center gap-4",children:e.jsxs(j,{variant:"ghost",onClick:()=>t("/assessments"),children:[e.jsx($,{className:"h-4 w-4 mr-2"}),"Back to Assessments"]})}),e.jsx(x,{className:"border-destructive",children:e.jsxs(u,{className:"pt-6",children:[e.jsxs("div",{className:"flex items-center gap-2 text-destructive mb-2",children:[e.jsx(O,{className:"h-5 w-5"}),e.jsx("span",{className:"font-semibold",children:"Error Loading Assessment"})]}),e.jsx("p",{children:v})]})})]});if(!a)return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex items-center gap-4",children:e.jsxs(j,{variant:"ghost",onClick:()=>t("/assessments"),children:[e.jsx($,{className:"h-4 w-4 mr-2"}),"Back to Assessments"]})}),e.jsx(x,{children:e.jsx(u,{className:"pt-6",children:e.jsx("p",{children:"Assessment not found"})})})]});const S=m=>{switch(m==null?void 0:m.toLowerCase()){case"completed":return"default";case"in progress":return"secondary";case"planning":return"outline";case"on hold":return"destructive";default:return"secondary"}},N=m=>{switch(m==null?void 0:m.toLowerCase()){case"completed":return e.jsx(L,{className:"h-4 w-4"});case"in progress":return e.jsx(Y,{className:"h-4 w-4"});case"planning":return e.jsx(X,{className:"h-4 w-4"});case"on hold":return e.jsx(O,{className:"h-4 w-4"});default:return e.jsx(Y,{className:"h-4 w-4"})}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs(j,{variant:"ghost",onClick:()=>t("/assessments"),children:[e.jsx($,{className:"h-4 w-4 mr-2"}),"Back to Assessments"]}),e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-bold flex items-center gap-2",children:[e.jsx(T,{className:"h-8 w-8"}),a.name]}),e.jsxs("p",{className:"text-muted-foreground",children:[a.framework," • ",a.type||"Assessment"]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(j,{variant:"outline",size:"sm",children:[e.jsx(os,{className:"h-4 w-4 mr-2"}),"Edit"]}),e.jsxs(j,{variant:"outline",size:"sm",children:[e.jsx(ls,{className:"h-4 w-4 mr-2"}),"Export"]})]})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-4",children:[e.jsxs(x,{children:[e.jsxs(p,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(g,{className:"text-sm font-medium",children:"Status"}),N(a.status)]}),e.jsxs(u,{children:[e.jsx(I,{variant:S(a.status),className:"mb-2",children:a.status||"Unknown"}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Progress: ",a.progress||0,"%"]}),e.jsx(be,{value:a.progress||0,className:"mt-2"})]})]}),e.jsxs(x,{children:[e.jsxs(p,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(g,{className:"text-sm font-medium",children:"Due Date"}),e.jsx(M,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(u,{children:[e.jsx("div",{className:"text-2xl font-bold",children:a.due_date?new Date(a.due_date).toLocaleDateString():"Not set"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:a.due_date&&new Date(a.due_date)<new Date?"Overdue":"On schedule"})]})]}),e.jsxs(x,{children:[e.jsxs(p,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(g,{className:"text-sm font-medium",children:"Lead Assessor"}),e.jsx(ds,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(u,{children:[e.jsx("div",{className:"text-2xl font-bold",children:a.assessor||"Unassigned"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Primary contact"})]})]}),e.jsxs(x,{children:[e.jsxs(p,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(g,{className:"text-sm font-medium",children:"Framework"}),e.jsx(T,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(u,{children:[e.jsx("div",{className:"text-lg font-bold",children:a.framework}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Compliance standard"})]})]})]}),e.jsxs(Ts,{defaultValue:"overview",className:"w-full",children:[e.jsxs(Re,{children:[e.jsx(A,{value:"overview",children:"Overview"}),e.jsx(A,{value:"controls",children:"Controls"}),e.jsx(A,{value:"evidence",children:"Evidence"}),e.jsx(A,{value:"findings",children:"Findings"}),e.jsx(A,{value:"reports",children:"Reports"})]}),e.jsx(E,{value:"overview",className:"space-y-4",children:e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs(x,{children:[e.jsx(p,{children:e.jsx(g,{children:"Assessment Details"})}),e.jsxs(u,{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-muted-foreground",children:"Description:"}),e.jsx("p",{className:"mt-1",children:a.description||"No description provided"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-muted-foreground",children:"Scope:"}),e.jsx("p",{className:"mt-1",children:a.scope||"No scope defined"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-muted-foreground",children:"Created:"}),e.jsx("p",{className:"mt-1",children:a.created_date?new Date(a.created_date).toLocaleDateString():"Unknown"})]})]})]}),e.jsxs(x,{children:[e.jsx(p,{children:e.jsx(g,{children:"Recent Activity"})}),e.jsx(u,{children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),e.jsx("span",{children:"Assessment created"}),e.jsx("span",{className:"text-muted-foreground ml-auto",children:a.created_date?new Date(a.created_date).toLocaleDateString():"Unknown"})]}),e.jsx("div",{className:"text-center py-4 text-muted-foreground text-sm",children:"More activity will appear here as the assessment progresses"})]})})]})]})}),e.jsx(E,{value:"controls",className:"space-y-4",children:e.jsxs(x,{children:[e.jsxs(p,{children:[e.jsx(g,{children:"Control Assessment"}),e.jsx(P,{children:"Framework controls and their assessment status"})]}),e.jsx(u,{children:e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx(T,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),e.jsx("p",{children:"Control assessment functionality coming soon"})]})})]})}),e.jsx(E,{value:"evidence",className:"space-y-4",children:e.jsxs(x,{children:[e.jsxs(p,{children:[e.jsx(g,{children:"Evidence Collection"}),e.jsx(P,{children:"Supporting documentation and evidence for controls"})]}),e.jsx(u,{children:e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx(cs,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),e.jsx("p",{children:"Evidence management functionality coming soon"})]})})]})}),e.jsx(E,{value:"findings",className:"space-y-4",children:e.jsxs(x,{children:[e.jsxs(p,{children:[e.jsx(g,{children:"Assessment Findings"}),e.jsx(P,{children:"Issues, gaps, and recommendations identified during assessment"})]}),e.jsx(u,{children:e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx(O,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),e.jsx("p",{children:"Findings tracking functionality coming soon"})]})})]})}),e.jsx(E,{value:"reports",className:"space-y-4",children:e.jsxs(x,{children:[e.jsxs(p,{children:[e.jsx(g,{children:"Assessment Reports"}),e.jsx(P,{children:"Generated reports and documentation"})]}),e.jsx(u,{children:e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx(X,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),e.jsx("p",{children:"Report generation functionality coming soon"})]})})]})})]})]})}const Vs=Object.freeze(Object.defineProperty({__proto__:null,default:Cs},Symbol.toStringTag,{value:"Module"}));export{Rs as A,j as B,x as C,gs as D,Fs as E,$s as F,Ts as G,Re as H,R as I,A as J,E as K,J as L,Gs as M,Us as N,Vs as O,be as P,ee as S,G as T,u as a,p as b,g as c,P as d,I as e,_s as f,Ds as g,i as h,Bs as i,Ls as j,Is as k,ze as l,Se as m,Ce as n,Ae as o,z as p,B as q,Os as r,se as s,U as t,V as u,Ns as v,ws as w,_e as x,De as y,Te as z};
